This exploit uses a local privilege excalation in OpenBSD's dynamic loader (ld.so)

This exploit works in OpenBSD 6.*, with 6.6 being the latest tested version for this exploit.

To use the exploit, compile the file lib.c with the following command:
gcc -fpic -shared -s -o libutil.so.13.1 lib.c

and then the file poc.c with the following command:
gcc -s -o poc poc.c

and finally run the program targeting the following file:
./poc /usr/bin/chpass

after this, root access to the machine should be granted.

This exploit was discovered by Qualys Security Advisory 
and can be found at the following links: 
https://seclists.org/bugtraq/2019/Dec/25
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19726
